<!DOCTYPE html>
<html lang="en">
        <script>var version="021016-0102"</script>
	<head>
		<title>CHESS BOARDz</title>
		<meta http-equiv="cache-control" content="max-age=0" />
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="expires" content="0" />
		<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
		<meta http-equiv="pragma" content="no-cache" />
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
                <link rel="stylesheet" type="text/css" href="css/theme.css">	
	</head>
	
	<body style='' onkeypress='game.keypress(event)' onload='javascript:createGame();' >
	
	<div id="info">	
	<table border="0" style="background-color:#000000;color:#FFFFFF;width:100%" cellpadding="3" cellspacing="1">
	<tr>	
	<td width="18%" rowspan="2" > <button id="wbut" style="background: white;float: left;width: 100%;line-height:100px;" type="button"  onclick="spin=3;game.player1.play();" >WHITE</button> </td>
	<td rowspan="2" > <div id='player1clock'>0:00</div> </td>
	<td><CENTER> <button style="background: white;" type="button">START GAME</button></CENTER></td>
	<td rowspan="2" > <div id='player2clock'>0:00</div> </td>
	<td width="18%" rowspan="2" > <button id="wbut" style="background: white;float: right;;width: 100%;heigth: 100%;line-height:100px;" type="button" onclick="spin=2;game.player2.play();" >BLACK</button> </td>
	</tr>
	<tr>
	<td width="50%" ><CENTER> <div id='infodata' class='hidden'> </CENTER></div> </td>
	</tr>
	</table>
     	</div>			
			
    	<script src="js/chesstimer.js"></script>
    	<script src="js/three.min.js"></script>
	<script src="js/loaders/collada/Animation.js"></script>
	<script src="js/loaders/collada/AnimationHandler.js"></script>
	<script src="js/loaders/collada/KeyFrameAnimation.js"></script>
	<script src="js/loaders/ColladaLoader.js"></script>
	<script src="js/Detector.js"></script>

		         
	</div>			
	<div id="openModal" class="modalDialog">
	<div>
	<a href="#close" title="Close" class="close">X</a>
	<h2>About CHESS BOARDz</h2>
	<p>Work In Progress : Game is not playable at this time.</p>
	<p>Version: <script>document.write(version)</script></p>
	<p>GITHUB:</p><p>https://github.com/icarusfactor/CHESS-BOARDz</p>
	<p>Programmer: Daniel Yount aka icarus[factor] </p>
	</div>
	</div>
	
			 
	<div id="status">
			
	<nav id="main-nav">
	<ul>   
	    <li><a href="javascript:location.reload();">CHESS BOARDz</a></li>   
	    <li  style="float:right;list-style-type:none;"  ><a href="#openModal">About</a></li>  
	    <li  style="float:right;list-style-type:none;"  ><a href="#">View</a>
        <ul class="main-nav-sub">
	    <li><a href="javascript:setSpinCAM();">ROTATE</a></li>
	    <li><a href="javascript:setBlackCAM();">BLACK 3/4</a></li>
	    <li><a href="javascript:setWhiteCAM();">WHITE 3/4</a></li>
	    <li><a href="javascript:setTopCAM();">TOP</a></li> 
        </ul>
       	    </li>
            <li  style="float:right;list-style-type:none;"  ><a href="#">Action</a>
        <ul class="main-nav-sub">
       	    <!-- <li><a href="javascript:init();">INIT</a></li> -->
            <li><a href="javascript:game.pause();">PAUSE</a></li>
            <li><a href="javascript:game.addTime();">+ TIME</a></li>
            <li><a href="javascript:game.removeTime();">- TIME</a></li>
            <li><a href="javascript:game.resetClocks();">RESET CLOCKS</a></li>
       
        </ul>
    	   </li>
	</ul>
	</nav>		
	
	</div>			
  			
    

		

		<script>  if ( ! Detector.webgl ) Detector.addGetWebGLMessage();</script>
		
		<script src="js/init.js"></script>
		<!-- init() is hiding in here. the only way i could get it to work.  -->
		<script src="js/colladapieces.js"></script>
		<script src="js/colladamaterials.js"></script>
		<script src="js/chessboardparts.js"></script>
		
		<script>

			
			var container;
			var camera, scene, renderer, raycaster ,objects,spin;
			var particleLight;
			
			
			var mouse = new THREE.Vector2(), INTERSECTED,SELECTED;
			
						
			raycaster = new THREE.Raycaster();	
			var clock = new THREE.Clock();
			
			
			
			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}
			

			function onDocumentMouseMove( event ) {

				event.preventDefault();

				mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
				mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

			}
			
			
			
			
			var setSpinCAM = function() {	
				spin = 1;	
				
				//Roate around board
				var timer = Date.now() * 0.0005;
				camera.position.x = Math.cos( timer ) * 10;
				camera.position.y = 7.5;
				camera.position.z = Math.sin( timer ) * 10;
				

				
				particleLight.position.x = Math.sin( timer * 4 ) * 3009;
				particleLight.position.y = Math.cos( timer * 5 ) * 4000;
				particleLight.position.z = Math.cos( timer * 4 ) * 3009;
				
							
				}
			
				
			var setWhiteCAM = function() {	
				spin = 2;	
				
				//White position
				camera.position.x = 6;
				camera.position.y = 7.5;
				camera.position.z = 10;
				
				particleLight.position.x = -3009;
				particleLight.position.y = 4000;
				particleLight.position.z = -3009;	
											
				}
				
				
			var setBlackCAM = function() {	
				spin = 3;  
								 
				 //Black position
				camera.position.x = 6;
				camera.position.y = 7.5;
				camera.position.z = -10;
				
				particleLight.position.x = 3009;
				particleLight.position.y = 4000;
				particleLight.position.z = 3009;
				
								
				}	
				
			
			var setTopCAM = function() {
				spin = 4;	
				
				//Top position			        
				camera.position.x = 0;
				camera.position.y = 15;
				camera.position.z = 0;
				
				particleLight.position.x = 0;
				particleLight.position.y = 25000;
				particleLight.position.z = 0;
						
				}
			

			var findIntersections = function () {
				// find intersections
				scene.updateMatrixWorld();
				camera.updateMatrixWorld();
				raycaster.setFromCamera( mouse, camera );
				
				var intersects = raycaster.intersectObjects( scene.children,true );

				if ( intersects.length > 0 ) {
				
					SELECTED = intersects[ 0 ].object;

					if ( INTERSECTED != intersects[ 0 ].object ) {

						if ( INTERSECTED ) {
						 INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
						}

						INTERSECTED = intersects[ 0 ].object;
						INTERSECTED.currentHex = INTERSECTED.material.color.getHex();
						INTERSECTED.name = INTERSECTED.material.name;
						if(INTERSECTED.name != "grid" ) { 
						//console.log("PIECE: "+INTERSECTED.name );
						game.infodata.innerHTML = " "+INTERSECTED.name+" " ;
						INTERSECTED.material.color.setHex( 0xff0000 );
   						}
					}

				} else {

					if ( INTERSECTED ) INTERSECTED.material.color.setHex( INTERSECTED.currentHex );

					INTERSECTED = null;

				}


				 } //end of findIntersections
			
			

			function render() {
			
			
			      findIntersections();

                              if( spin == 1 ){
                              	//Roate around board                              	
                              	setSpinCAM();				
				}		

				
				camera.lookAt( scene.position );

				THREE.AnimationHandler.update( clock.getDelta() );

				renderer.render( scene, camera );
			}
			
		 init();  //  HAVE NO CLUE WHY IT DOES NOT WORK HERE.	
	</script>
	
	</body>
</html>
